<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        font-family: sans-serif;
      }
      .container {
        display: flex;
        gap: 2px;
        user-select: none;
      }
      .box {
        width: 20px;
        height: 80px;
        background: #ccc;
        transition: background 0.1s;
      }
    </style>
  </head>
  <body>
    <div class="container"></div>
    <!-- 
    <script>
      const container = document.querySelector(".container");

      // CREATE 300 BOXES (heavy)
      for (let i = 0; i < 300; i++) {
        const div = document.createElement("div");
        div.className = "box";
        container.appendChild(div);
      }

      const boxes = document.querySelectorAll(".box");

      // âŒ VERY BAD: expensive mousemove
      document.addEventListener("mousemove", () => {
        boxes.forEach((box) => {
          // force layout + paint
          box.style.height = Math.random() * 100 + "px";
          box.style.background = `rgb(${Math.random() * 255},0,0)`;
        });
      });
    </script> -->

    <script>
      const container = document.querySelector(".container");

      for (let i = 0; i < 300; i++) {
        const div = document.createElement("div");
        div.className = "box";
        container.appendChild(div);
      }

      const boxes = Array.from(document.querySelectorAll(".box"));
      let lastIndex = null;

      container.addEventListener("mousemove", (e) => {
        const rect = container.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const index = Math.floor(x / 22);

        if (index === lastIndex) return;

        if (lastIndex !== null && boxes[lastIndex]) {
          boxes[lastIndex].style.height = "80px";
          boxes[lastIndex].style.background = "#ccc";
        }

        if (boxes[index]) {
          boxes[index].style.height = "120px";
          boxes[index].style.background = "red";
        }

        lastIndex = index;
      });
    </script>
  </body>
</html>
